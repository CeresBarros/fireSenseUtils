<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>fireSense tutorial • fireSenseUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="fireSense tutorial">
<meta property="og:description" content="fireSenseUtils">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fireSenseUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fireSense-tutorial.html">fireSense tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PredictiveEcology/fireSenseUtils/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fireSense-tutorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>fireSense tutorial</h1>
                        <h4 class="author">Jean Marchal, Eliot McIntire, Tati Micheletti, Alex Chubaty</h4>
            
            <h4 class="date">2020-09-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PredictiveEcology/fireSenseUtils/blob/master/vignettes/fireSense-tutorial.Rmd"><code>vignettes/fireSense-tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>fireSense-tutorial.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>fireSense</code> is a spatially explicit landscape fire model, that is, it simulates the fire disturbance in the landscape. <code>fireSense</code> is implemented as a group of <code>SpaDES</code> modules. A main asset of <code>fireSense</code> is that it can be parameterized directly from data using systematic methods while incorporating sensitivity to different environmental drivers.</p>
<p>To better represent how environmental drivers control fire, <code>fireSense</code> breaks down the fire process into three stages: ignition, escape, and spread. Sensitivity to environmental drivers can be introduced at each of these stages and these factors need not necessarily be identical for all stages. This way each module can be adapted to your own problem and used to answer your own questions.</p>
<p>In order to facilitate the parameterization of <code>fireSense</code> from data using systematic methods we have created SpaDES modules dedicated to these tasks:</p>
<ul>
<li><code>fireSense_IgnitionFit</code></li>
<li><code>fireSense_EscapeFit</code></li>
<li><code>fireSense_SpreadFit</code></li>
</ul>
<p>These follow the way <code>fireSense</code> breaks down the fire process and are named accordingly. For example, <code>fireSense_IgnitionFit</code> implements methods to fit the statistical model of fire ignitions. The <code>fireSense_IgnitionFit</code> module implements methods described in Marchal et al. <span class="citation">(2017)</span>, <code>fireSense_EscapeFit</code> and <code>fireSense_SpreadFit</code> implement methods described in Marchal et al. <span class="citation">(2019)</span>. Each of these modules is associated with an additional module to facilitate the production of predictive maps (rasters) or data sets (data.frames). To continue with the example of fire ignitions, the module <code>fireSense_IgnitionPredict</code> is associated with the <code>fireSense_IgnitionFit</code> module. One possible use of the <code>fireSense_IgnitionPredict</code> module would be to generate rasters describing in a spatially explicit way the predicted ignition rates.</p>
<p>In addition of these modules, we implemented the <code>fireSense_SizeFit</code> module to fit statistical model of the fire size distribution using the tapered Pareto distribution <span class="citation">(Schoenberg, Peng, and Woods 2003)</span>. The use of <code>fireSense_SizeFit</code> is not a requirement because these outputs are not required by <code>fireSense</code>. Although the use of <code>fireSense_SizeFit</code> is optional, it can be used to reduce the dimensionality of the problem, which helps speed up and facilitate convergence when using the . module later. Later in this tutorial we will show how the outputs of the <code>fireSense_SizeFit</code> module can be used as inputs of the <code>fireSense_SpreadFit</code> module.</p>
<p>Alternatively, the parameter of the tapered Pareto distribution can be used as inputs of the spread model assuming these capture the effect of environmental drivers of fire sizes.</p>
<p>We start by fitting the spread model using the <code>fireSense_SpreadFit</code> module. In order to fit this model we need data about the shape of the fire size distribution. We can predict it using the <code>fireSense_SizePredict</code> module and fit the model to our study region using the <code>fireSense_SizeFit</code> module.</p>
<p>This tutorial is intended to provide examples to run all <code>fireSense</code> modules without the need to download actual data. Depending on the fact that some of them have dependencies.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># Create a raster template describing the study area</span>
<span class="no">raster_width</span> <span class="kw">&lt;-</span> <span class="no">raster_height</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">r_template</span> <span class="kw">&lt;-</span> <span class="fu">raster</span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw">nrow</span> <span class="kw">=</span> <span class="no">raster_height</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="no">raster_width</span>))

<span class="co"># Create rasters describing environmental drivers controlling fire</span>
<span class="co"># Here we use for example the land cover and the weather</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)

<span class="co">## Landcover -- these should be "proportion of that single cover type", e.g., Proportion Deciduous</span>
<span class="no">landTypeOne</span> <span class="kw">&lt;-</span> <span class="fu">gaussMap</span>(<span class="no">r_template</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">300</span>, <span class="kw">var</span> <span class="kw">=</span> <span class="fl">300</span>)
<span class="no">landTypeOne</span> <span class="kw">&lt;-</span> <span class="fu">normalizeRaster</span>(<span class="no">landTypeOne</span>)
<span class="no">landTypeTwo</span> <span class="kw">&lt;-</span> <span class="fl">1</span> - <span class="no">landTypeOne</span>

<span class="co">## Weather</span>
<span class="no">weather</span> <span class="kw">&lt;-</span> <span class="fu">gaussMap</span>(<span class="no">r_template</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">300</span>, <span class="kw">var</span> <span class="kw">=</span> <span class="fl">3000</span>)

<span class="co"># Create low resolution rasters of the environmental drivers</span>
<span class="co"># These are used for fitting the ignition model. The main advantages</span>
<span class="co"># of fire modeling using low resolution are described in Marchal et al. 2017. </span>
<span class="co"># In short, unlike high-resolution modeling, fire locations need not be known</span>
<span class="co"># precisely and do not require data at scales where local homogeneity of </span>
<span class="co"># landcover can be assumed.</span>

<span class="no">landTypeOneLowRes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="no">landTypeOne</span>, <span class="kw">fact</span> <span class="kw">=</span> <span class="fl">25</span>, <span class="kw">fun</span> <span class="kw">=</span> <span class="no">mean</span>)
<span class="no">landTypeTwoLowRes</span> <span class="kw">&lt;-</span> <span class="fl">1</span> - <span class="no">landTypeOneLowRes</span>

<span class="no">weatherLowRes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="no">weather</span>, <span class="kw">fact</span> <span class="kw">=</span> <span class="fl">25</span>, <span class="kw">fun</span> <span class="kw">=</span> <span class="no">mean</span>)

<span class="co"># Let's use a known pattern / equation</span>
<span class="no">nbFires</span> <span class="kw">&lt;-</span> <span class="fl">500</span>
<span class="no">fireLocations</span> <span class="kw">&lt;-</span> <span class="fu">rpoint</span>(<span class="no">nbFires</span>, <span class="kw">f</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>, <span class="no">...</span>) <span class="fl">300</span> * <span class="no">y</span>) <span class="co"># Introduce some spatial variability: more fires in the North</span>
<span class="no">fireLocations</span> <span class="kw">&lt;-</span> <span class="fu">as</span>(<span class="no">fireLocations</span>, <span class="st">"SpatialPoints"</span>)

<span class="co">#landcoverDataLowRes &lt;- extract(landTypeOneLowRes, fireLocations, cellnumbers = TRUE) %&gt;%</span>
<span class="co">#  as_tibble %&gt;%</span>
<span class="co">#  rename(cell_id = 1, landtype_1_pp = 2) %&gt;% # Rename columns using column index</span>
<span class="co">#  distinct(cell_id, landtype_1_pp) %&gt;%</span>
<span class="co">#  mutate(landtype_2_pp = 1 - landtype_1_pp)  # Add a column with the 2nd landcover type</span>

<span class="co">#weatherDataLowRes &lt;- extract(weatherLowRes, fireLocations, cellnumbers = TRUE) %&gt;%</span>
<span class="co">#  as_tibble %&gt;% </span>
<span class="co">#  rename(cell_id = 1, weather = 2) %&gt;% # Rename columns using column index</span>
<span class="co">#  distinct(cell_id, weather)</span>

<span class="co"># Create the dataset necessary to fit the statistical model of fire ignitions</span>
<span class="co">#dataFireSense_IgnitionFit &lt;- landcoverDataLowRes %&gt;%</span>
<span class="co">#  group_by(cell_id) %&gt;%</span>
<span class="co">#  summarise(n_fires = n()) %&gt;%</span>
<span class="co">#  right_join(landcoverDataLowRes) %&gt;%</span>
<span class="co">#  left_join(weatherDataLowRes) %&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">n_fires</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">n_fires</span>), <span class="fl">0</span>, <span class="no">n_fires</span>))

<span class="co"># Converting the above from tibble to data.table </span>
<span class="no">dataFireSense_IgnitionFit</span> <span class="kw">&lt;-</span> <span class="fu">data.table</span>(
  <span class="fu">extract</span>(<span class="no">landTypeOneLowRes</span>, <span class="no">fireLocations</span>, <span class="kw">cellnumbers</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="kw">landtype_2_pp</span> <span class="kw">=</span> <span class="fu">extract</span>(<span class="no">landTypeTwoLowRes</span>, <span class="no">fireLocations</span>, <span class="kw">cellnumbers</span> <span class="kw">=</span> <span class="fl">FALSE</span>),
  <span class="kw">weather</span> <span class="kw">=</span> <span class="fu">extract</span>(<span class="no">weatherLowRes</span>, <span class="no">fireLocations</span>, <span class="kw">cellnumbers</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  )
<span class="fu">setnames</span>(<span class="no">dataFireSense</span>, <span class="kw">old</span> <span class="kw">=</span> <span class="st">"layer"</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="st">"landtype_1_pp"</span>)
<span class="no">dataFireSense_IgnitionFit</span> <span class="kw">&lt;-</span> <span class="no">dataFireSense</span>[, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">n_fires</span> <span class="kw">=</span> <span class="no">.N</span>, <span class="kw">landtype_1_pp</span> <span class="kw">=</span> <span class="no">landtype_1_pp</span>[<span class="fl">1</span>],
  <span class="kw">landtype_2_pp</span> <span class="kw">=</span> <span class="no">landtype_2_pp</span>[<span class="fl">1</span>], <span class="kw">weather</span> <span class="kw">=</span> <span class="no">weather</span>[<span class="fl">1</span>]
), <span class="kw">by</span> <span class="kw">=</span> <span class="no">cells</span>]

<span class="no">dataFireSense_EscapeFit</span> <span class="kw">&lt;-</span> <span class="fu">data.table</span>(
  <span class="kw">landtype_1_pp</span> <span class="kw">=</span> <span class="fu">extract</span>(<span class="no">landTypeOne</span>, <span class="no">fireLocations</span>, <span class="kw">cellnumbers</span> <span class="kw">=</span> <span class="fl">FALSE</span>),
  <span class="kw">landtype_2_pp</span> <span class="kw">=</span> <span class="fu">extract</span>(<span class="no">landTypeTwo</span>, <span class="no">fireLocations</span>, <span class="kw">cellnumbers</span> <span class="kw">=</span> <span class="fl">FALSE</span>),
  <span class="kw">weather</span> <span class="kw">=</span> <span class="fu">extract</span>(<span class="no">weather</span>, <span class="no">fireLocations</span>, <span class="kw">cellnumbers</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  )

<span class="co"># Create the dataset necessary to fit the statistical model fire escapes</span>
<span class="co">#dataFireSense_EscapeFit &lt;- tibble(</span>
<span class="co">#  landtype_1_pp = extract(landTypeOne, fireLocations),</span>
<span class="co">#  landtype_2_pp = extract(landTypeTwo, fireLocations),</span>
<span class="co">#  weather = extract(weather, fireLocations)</span>
<span class="co">#)</span>

<span class="no">b1</span> <span class="kw">&lt;-</span> <span class="fl">.01</span>
<span class="no">b2</span> <span class="kw">&lt;-</span> -<span class="fl">1</span>
<span class="no">b3</span> <span class="kw">&lt;-</span> <span class="fl">1</span>

<span class="no">escapeProb</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">dataFireSense_EscapeFit</span>, <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>()$<span class="fu">linkinv</span>(<span class="no">weather</span> * <span class="no">b1</span> + <span class="no">landtype_1_pp</span> * <span class="no">b2</span> + <span class="no">landtype_2_pp</span> * <span class="no">b3</span>))
<span class="no">escaped</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="no">nbFires</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="no">escapeProb</span>)

<span class="no">dataFireSense_EscapeFit</span>[, <span class="fu">`:=`</span>(<span class="kw">escaped</span> <span class="kw">=</span> <span class="no">escaped</span>, <span class="kw">n_fires</span> <span class="kw">=</span> <span class="fl">1</span>)]
<span class="co"># dataFireSense_EscapeFit &lt;- mutate(dataFireSense_EscapeFit, escaped = escaped, n_fires = 1)</span>

<span class="co"># Create the dataset necessary to fit the statistical model of the fire size distribution</span>
<span class="co"># Calculate mean landcover and weather conditions around the locations of escaped fires</span>
<span class="no">buf_around_loc_escaped</span> <span class="kw">&lt;-</span> <span class="fu">gBuffer</span>(<span class="no">fireLocations</span>[<span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span>(<span class="no">escaped</span>)], <span class="kw">byid</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">.03</span>)

<span class="no">landtypeTypeOneBufMn</span> <span class="kw">&lt;-</span> <span class="fu">extract</span>(<span class="no">landTypeOne</span>, <span class="no">buf_around_loc_escaped</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">mean</span>) <span class="kw">%&gt;%</span>
  <span class="no">unlist</span>

<span class="no">landtypeTypeTwoBufMn</span> <span class="kw">&lt;-</span> <span class="fu">extract</span>(<span class="no">landTypeTwo</span>, <span class="no">buf_around_loc_escaped</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">mean</span>) <span class="kw">%&gt;%</span>
  <span class="no">unlist</span>

<span class="no">weatherBufMn</span> <span class="kw">&lt;-</span> <span class="fu">extract</span>(<span class="no">weather</span>, <span class="no">buf_around_loc_escaped</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">mean</span>) <span class="kw">%&gt;%</span>
  <span class="no">unlist</span>

<span class="no">dataFireSense_SizeFit</span> <span class="kw">&lt;-</span> <span class="fu">data.table</span>(
  <span class="kw">landtype_1_pp</span> <span class="kw">=</span> <span class="no">landtypeTypeOneBufMn</span>,
  <span class="kw">landtype_2_pp</span> <span class="kw">=</span> <span class="no">landtypeTypeTwoBufMn</span>,
  <span class="kw">weather</span> <span class="kw">=</span> <span class="no">weatherBufMn</span>
)

<span class="no">b1_l</span> <span class="kw">&lt;-</span> -<span class="fl">.03</span>
<span class="no">b2_l</span> <span class="kw">&lt;-</span> <span class="fl">4</span>
<span class="no">b3_l</span> <span class="kw">&lt;-</span> -<span class="fl">2</span>

<span class="no">lambda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">dataFireSense_SizeFit</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">weather</span> * <span class="no">b1_l</span> + <span class="no">landtype_1_pp</span> * <span class="no">b2_l</span> + <span class="no">landtype_2_pp</span> * <span class="no">b3_l</span>))

<span class="no">b1_t</span> <span class="kw">&lt;-</span> <span class="fl">.02</span>
<span class="no">b2_t</span> <span class="kw">&lt;-</span> <span class="fl">4</span>
<span class="no">b3_t</span> <span class="kw">&lt;-</span> <span class="fl">2</span>

<span class="no">theta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">dataFireSense_SizeFit</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">weather</span> * <span class="no">b1_t</span> + <span class="no">landtype_1_pp</span> * <span class="no">b2_t</span> + <span class="no">landtype_2_pp</span> * <span class="no">b3_t</span>))

<span class="no">fireSize</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu">rtappareto</span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">lambda</span>), <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">lambda</span>, <span class="kw">theta</span> <span class="kw">=</span> <span class="no">theta</span>, <span class="kw">a</span> <span class="kw">=</span> <span class="fl">1</span>))

<span class="no">dataFireSense_SizeFit</span>[, <span class="no">fire_size</span> <span class="kw">:=</span> <span class="no">fireSize</span>]
<span class="co"># dataFireSense_SizeFit &lt;- mutate(dataFireSense_SizeFit, fire_size = fireSize)</span>

<span class="co"># Create the fire attribute dataset that describes the starting locations </span>
<span class="co"># and the size of the fires to be spread. This is needed to fit the statistical model of spread probabilities</span>
<span class="no">fireAttributesFireSense_SpreadFit</span> <span class="kw">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(<span class="no">fireLocations</span>[<span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span>(<span class="no">escaped</span>)], <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="no">fireSize</span>))</pre></body></html></div>
<div id="fit-the-statistical-model-of-fire-ignitions" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-the-statistical-model-of-fire-ignitions" class="anchor"></a>Fit the statistical model of fire ignitions</h2>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_IgnitionFit"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_IgnitionFit module inputs</span>
<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dataFireSense_IgnitionFit</span> <span class="kw">=</span> <span class="no">dataFireSense_IgnitionFit</span>)

<span class="co"># Define fireSense_IgnitionFit module parameters</span>
<span class="no">formula</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(<span class="no">n_fires</span> ~ <span class="no">landtype_1_pp</span>:<span class="no">weather</span> + <span class="no">landtype_2_pp</span>:<span class="no">weather</span> - <span class="fl">1</span>)
<span class="no">family</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span>(<span class="kw">link</span> <span class="kw">=</span> <span class="st">"identity"</span>)
<span class="no">ub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">coef</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="no">dataObjName</span> <span class="kw">&lt;-</span> <span class="st">"dataFireSense_IgnitionFit"</span>
<span class="no">trace</span> <span class="kw">&lt;-</span> <span class="fl">1</span>
<span class="no">iterDEoptim</span> <span class="kw">&lt;-</span> <span class="fl">60</span>
<span class="no">iterNlminb</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">cores</span> <span class="kw">&lt;-</span> <span class="fl">50</span>

<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_IgnitionFit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">formula</span> <span class="kw">=</span> <span class="no">formula</span>,           <span class="co"># Formula of the statistical model</span>
    <span class="kw">family</span> <span class="kw">=</span> <span class="no">family</span>,             <span class="co"># Distribution family, here the negative binomial distribution</span>
    <span class="kw">ub</span> <span class="kw">=</span> <span class="no">ub</span>,                     <span class="co"># Upper bounds for coefficients to be estimated</span>
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">dataObjName</span>,          <span class="co"># Name of the data.frame containing the variables in the statistical model. By default "dataFireSense_IgnitionFit"</span>
    <span class="kw">trace</span> <span class="kw">=</span> <span class="no">trace</span>,               <span class="co"># Print progress every 10 iterations</span>
    <span class="kw">iterDEoptim</span> <span class="kw">=</span> <span class="no">iterDEoptim</span>,   <span class="co"># Integer defining the maximum number of iterations allowed for the DEoptim optimizer</span>
    <span class="kw">iterNlminb</span> <span class="kw">=</span> <span class="no">iterNlminb</span>,     <span class="co"># Number of trials, or searches, to be performed by the nlminb optimizer in order to find the best solution</span>
    <span class="kw">cores</span> <span class="kw">=</span> <span class="no">cores</span>              <span class="co"># Number of logical cores to use for parallel computation during optimization</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)

<span class="no">fireSense_IgnitionFitted</span> <span class="kw">&lt;-</span> <span class="no">sim</span>$<span class="no">fireSense_IgnitionFitted</span> <span class="co"># Extract the fitted model from the sim object</span></pre></body></html></div>
</div>
<div id="fit-the-statistical-model-of-fire-escapes" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-the-statistical-model-of-fire-escapes" class="anchor"></a>Fit the statistical model of fire escapes</h2>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_EscapeFit"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_EscapeFit module inputs</span>
<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dataFireSense_EscapeFit</span> <span class="kw">=</span> <span class="no">dataFireSense_EscapeFit</span>)

<span class="co"># Define fireSense_EscapeFit module parameters</span>
<span class="no">formula</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">escaped</span>, <span class="no">n_fires</span> - <span class="no">escaped</span>) ~ <span class="no">landtype_1_pp</span> + <span class="no">landtype_2_pp</span> + <span class="no">weather</span> - <span class="fl">1</span>)
<span class="no">dataObjName</span> <span class="kw">&lt;-</span> <span class="st">"dataFireSense_EscapeFit"</span>

<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_EscapeFit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">formula</span> <span class="kw">=</span> <span class="no">formula</span>, <span class="co"># Formula of the statistical model</span>
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">dataObjName</span> <span class="co"># Name of the data.frame containing the variables in the statistical model. By default "dataFireSense_EscapeFit"</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)

<span class="no">fireSense_EscapeFitted</span> <span class="kw">&lt;-</span> <span class="no">sim</span>$<span class="no">fireSense_EscapeFitted</span> <span class="co"># Extract the fitted model from the sim object</span></pre></body></html></div>
</div>
<div id="fit-the-statistical-model-of-the-spread-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-the-statistical-model-of-the-spread-probabilities" class="anchor"></a>Fit the statistical model of the spread probabilities</h2>
<p>The purpose of this step is to derive variable fire spread probabilities at the cell level, both spatially and temporally, which are sensitive to environmental drivers that control fire size.</p>
</div>
<div id="fit-the-statistical-model-of-the-fire-size-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-the-statistical-model-of-the-fire-size-distribution" class="anchor"></a>Fit the statistical model of the fire size distribution</h2>
<p>Although the use of fireSense_SizeFit is optional, it can be used to reduce the dimensionality of the problem, which helps speed up and facilitate convergence when using the fireSense_SpreadFit module later. Here, we use the fireSense_SizeFit module to model the relation between fire sizes and flammability conditions as represented by the drought index and the type of fuels. We then use the fireSense_SpreadFit module to convert the fitted equations produced by fireSense_SizeFit into variable probabilities of fire spread at the cell level, which are also sensitive to environmental drivers that control fire size.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_SizeFit"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_SizeFit module inputs</span>
<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dataFireSense_SizeFit</span> <span class="kw">=</span> <span class="no">dataFireSense_SizeFit</span>)

<span class="co"># Define fireSense_SizeFit module parameters</span>
<span class="no">formula</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(<span class="no">fire_size</span> ~ <span class="no">landtype_1_pp</span> + <span class="no">landtype_2_pp</span> + <span class="no">weather</span> - <span class="fl">1</span>)
<span class="no">dataObjName</span> <span class="kw">&lt;-</span> <span class="st">"dataFireSense_SizeFit"</span>

<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_SizeFit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">formula</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(     <span class="co"># Formulas of the statistical model</span>
      <span class="kw">beta</span> <span class="kw">=</span> <span class="no">formula</span>,   <span class="co"># The formulas for the beta and theta parameters of the tapered Pareto.</span>
      <span class="kw">theta</span> <span class="kw">=</span> <span class="no">formula</span>   <span class="co"># They do not have to be identical, even if it's the case here</span>
    ),
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">dataObjName</span>, <span class="co"># Name of the data.frame containing the variables in the statistical model. By default "dataFireSense_SizeFit"</span>
    <span class="kw">link</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
      <span class="kw">beta</span> <span class="kw">=</span> <span class="st">"log"</span>,     <span class="co"># Link function for the beta parameter of the tapered Pareto</span>
      <span class="kw">theta</span> <span class="kw">=</span> <span class="st">"log"</span>     <span class="co"># Link function for the theta parameter of the tapered Pareto</span>
    ),
    <span class="kw">a</span> <span class="kw">=</span> <span class="fl">1</span>,              <span class="co"># Lower truncation point a of the tapered Pareto</span>
    <span class="kw">ub</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
      <span class="kw">beta</span> <span class="kw">=</span> <span class="fl">10</span>,
      <span class="kw">theta</span> <span class="kw">=</span> <span class="fl">10</span>
    ),
    <span class="kw">itermax</span> <span class="kw">=</span> <span class="fl">2000</span>,
    <span class="kw">trace</span> <span class="kw">=</span> <span class="fl">100</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)

<span class="no">fireSense_SizeFitted</span> <span class="kw">&lt;-</span> <span class="no">sim</span>$<span class="no">fireSense_SizeFitted</span> <span class="co"># Extract the fitted model from the sim object</span></pre></body></html></div>
<div id="produce-the-maps-of-the-tapered-pareto-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#produce-the-maps-of-the-tapered-pareto-parameters" class="anchor"></a>Produce the maps of the tapered Pareto parameters</h3>
<div class="sourceCode" id="cb5"><html><body><pre class="r">
<span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_SizePredict"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_SizePredict module inputs</span>
<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_SizeFitted</span> <span class="kw">=</span> <span class="no">fireSense_SizeFitted</span>,
  <span class="kw">landtype_1_pp</span> <span class="kw">=</span> <span class="no">landTypeOne</span>,
  <span class="kw">landtype_2_pp</span> <span class="kw">=</span> <span class="no">landTypeTwo</span>,
  <span class="kw">weather</span> <span class="kw">=</span> <span class="no">weather</span>
)

<span class="co"># Define fireSense_SizePredict module outputs</span>
<span class="no">outputs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">file</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Beta.tif"</span>,
    <span class="kw">fun</span> <span class="kw">=</span> <span class="st">"writeRaster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Beta"</span>,
    <span class="kw">package</span> <span class="kw">=</span> <span class="st">"raster"</span>,
    <span class="kw">saveTime</span> <span class="kw">=</span> <span class="fl">1</span>
  ),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">file</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Theta.tif"</span>,
    <span class="kw">fun</span> <span class="kw">=</span> <span class="st">"writeRaster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Theta"</span>,
    <span class="kw">package</span> <span class="kw">=</span> <span class="st">"raster"</span>,
    <span class="kw">saveTime</span> <span class="kw">=</span> <span class="fl">1</span>
  )
)

<span class="co"># Define fireSense_SizePredict module parameters</span>
<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_SizePredict</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"landtype_1_pp"</span>, <span class="st">"landtype_2_pp"</span>, <span class="st">"weather"</span>),
    <span class="kw">modelName</span> <span class="kw">=</span> <span class="st">"fireSense_SizeFitted"</span> <span class="co"># This is the default</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">outputs</span> <span class="kw">=</span> <span class="no">outputs</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)</pre></body></html></div>
</div>
<div id="use-predicted-parameters-of-the-tapered-pareto-as-inputs-to-the-statistical-model-of-the-spread-probabilities" class="section level3">
<h3 class="hasAnchor">
<a href="#use-predicted-parameters-of-the-tapered-pareto-as-inputs-to-the-statistical-model-of-the-spread-probabilities" class="anchor"></a>Use predicted parameters of the tapered Pareto as inputs to the statistical model of the spread probabilities</h3>
<p>Here, we use the <code>fireSense_SpreadFit</code> module to convert them into spatially variable spread probabilities.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_SpreadFit"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_SpreadFit module inputs</span>
<span class="no">inputs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="co"># tapered Pareto's beta</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">files</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(
      <span class="fu">getPaths</span>()$<span class="no">outputPath</span>,
      <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Beta"</span>,
      <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>
    ),
    <span class="kw">functions</span> <span class="kw">=</span> <span class="st">"raster::raster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"beta"</span>,
    <span class="kw">loadTime</span> <span class="kw">=</span> <span class="fl">1</span>
  ),
  <span class="co"># tapered Pareto's theta</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">files</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(
      <span class="fu">getPaths</span>()$<span class="no">outputPath</span>,
      <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Theta"</span>,
      <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>
    ),
    <span class="kw">functions</span> <span class="kw">=</span> <span class="st">"raster::raster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"theta"</span>,
    <span class="kw">loadTime</span> <span class="kw">=</span> <span class="fl">1</span>
  )
)

<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">fireAttributesFireSense_SpreadFit</span> <span class="kw">=</span> <span class="no">fireAttributesFireSense_SpreadFit</span>)

<span class="co"># Define fireSense_SpreadFit module parameters</span>
<span class="no">formula</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(~ <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="fl">1</span>/<span class="no">beta</span>) + <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">theta</span>) - <span class="fl">1</span>)

<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_SpreadFit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">formula</span> <span class="kw">=</span> <span class="no">formula</span>, <span class="co"># Formula of the statistical model</span>
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"beta"</span>, <span class="st">"theta"</span>),
    <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.01</span>, <span class="fl">0</span>, <span class="fl">.1</span>, <span class="fl">.3</span>, <span class="fl">.001</span>, <span class="fl">.001</span>),
    <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.20</span>, <span class="fl">.1</span>, <span class="fl">10</span>, <span class="fl">4.</span>, <span class="fl">.300</span>, <span class="fl">.300</span>),
    <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">8</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="no">inputs</span>,
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)

<span class="no">fireSense_SpreadFitted</span> <span class="kw">&lt;-</span> <span class="no">sim</span>$<span class="no">fireSense_SpreadFitted</span> <span class="co"># Extract the fitted model from the sim object</span></pre></body></html></div>
</div>
</div>
<div id="predict-maps-of-fire-ignition-rates-escape-and-spread-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#predict-maps-of-fire-ignition-rates-escape-and-spread-probabilities" class="anchor"></a>Predict maps of fire ignition rates, escape and spread probabilities</h2>
<div id="fire-ignition-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#fire-ignition-rates" class="anchor"></a>Fire ignition rates</h3>
<div class="sourceCode" id="cb7"><html><body><pre class="r">
<span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_IgnitionPredict"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_IgnitionPredict module inputs</span>
<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_IgnitionFitted</span> <span class="kw">=</span> <span class="no">fireSense_IgnitionFitted</span>,
  <span class="kw">landtype_1_pp</span> <span class="kw">=</span> <span class="no">landTypeOne</span>,
  <span class="kw">landtype_2_pp</span> <span class="kw">=</span> <span class="no">landTypeTwo</span>,
  <span class="kw">weather</span> <span class="kw">=</span> <span class="no">weather</span>
)

<span class="co"># Define fireSense_IgnitionPredict module outputs</span>
<span class="no">outputs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fireSense_IgnitionPredicted.tif"</span>),
    <span class="kw">fun</span> <span class="kw">=</span> <span class="st">"writeRaster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"fireSense_IgnitionPredicted"</span>,
    <span class="kw">package</span> <span class="kw">=</span> <span class="st">"raster"</span>,
    <span class="kw">saveTime</span> <span class="kw">=</span> <span class="fl">1</span>
  )
)

<span class="co"># Define fireSense_IgnitionPredict module parameters</span>
<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_IgnitionPredict</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"landtype_1_pp"</span>, <span class="st">"landtype_2_pp"</span>, <span class="st">"weather"</span>),
    <span class="kw">modelName</span> <span class="kw">=</span> <span class="st">"fireSense_IgnitionFitted"</span> <span class="co"># This is the default</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">outputs</span> <span class="kw">=</span> <span class="no">outputs</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)</pre></body></html></div>
</div>
<div id="fire-escape-probabilities" class="section level3">
<h3 class="hasAnchor">
<a href="#fire-escape-probabilities" class="anchor"></a>Fire escape probabilities</h3>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_EscapePredict"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_EscapePredict module inputs</span>
<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_EscapeFitted</span> <span class="kw">=</span> <span class="no">fireSense_EscapeFitted</span>,
  <span class="kw">landtype_1_pp</span> <span class="kw">=</span> <span class="no">landTypeOne</span>,
  <span class="kw">landtype_2_pp</span> <span class="kw">=</span> <span class="no">landTypeTwo</span>,
  <span class="kw">weather</span> <span class="kw">=</span> <span class="no">weather</span>
)

<span class="co"># Define fireSense_EscapePredict module outputs</span>
<span class="no">outputs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fireSense_EscapePredicted.tif"</span>),
    <span class="kw">fun</span> <span class="kw">=</span> <span class="st">"writeRaster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"fireSense_EscapePredicted"</span>,
    <span class="kw">package</span> <span class="kw">=</span> <span class="st">"raster"</span>,
    <span class="kw">saveTime</span> <span class="kw">=</span> <span class="fl">1</span>
  )
)

<span class="co"># Define fireSense_EscapePredict module parameters</span>
<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_EscapePredict</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"landtype_1_pp"</span>, <span class="st">"landtype_2_pp"</span>, <span class="st">"weather"</span>),
    <span class="kw">modelName</span> <span class="kw">=</span> <span class="st">"fireSense_EscapeFitted"</span> <span class="co"># This is the default</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">outputs</span> <span class="kw">=</span> <span class="no">outputs</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)</pre></body></html></div>
</div>
<div id="fire-spread-probabilities" class="section level3">
<h3 class="hasAnchor">
<a href="#fire-spread-probabilities" class="anchor"></a>Fire spread probabilities</h3>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense_SpreadPredict"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense_SpreadPredict module inputs</span>
<span class="co"># tapered Pareto's beta</span>
<span class="no">inputs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">files</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(
      <span class="fu">getPaths</span>()$<span class="no">outputPath</span>,
      <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Beta"</span>,
      <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>
    ),
    <span class="kw">functions</span> <span class="kw">=</span> <span class="st">"raster::raster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"beta"</span>,
    <span class="kw">loadTime</span> <span class="kw">=</span> <span class="fl">1</span>
  ),
  <span class="co"># tapered Pareto's theta</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">files</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(
      <span class="fu">getPaths</span>()$<span class="no">outputPath</span>,
      <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"fireSense_SizePredicted_Theta"</span>,
      <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>
    ),
    <span class="kw">functions</span> <span class="kw">=</span> <span class="st">"raster::raster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"theta"</span>,
    <span class="kw">loadTime</span> <span class="kw">=</span> <span class="fl">1</span>
  )
)

<span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">fireSense_SpreadFitted</span> <span class="kw">=</span> <span class="no">fireSense_SpreadFitted</span>)

<span class="co"># Define fireSense_SpreadPredict module outputs</span>
<span class="no">outputs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fireSense_SpreadPredicted.tif"</span>),
    <span class="kw">fun</span> <span class="kw">=</span> <span class="st">"writeRaster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"fireSense_SpreadPredicted"</span>,
    <span class="kw">package</span> <span class="kw">=</span> <span class="st">"raster"</span>,
    <span class="kw">saveTime</span> <span class="kw">=</span> <span class="fl">1</span>
  )
)

<span class="co"># Define fireSense_SpreadPredict module parameters</span>
<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">fireSense_SpreadPredict</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"landtype_1_pp"</span>, <span class="st">"landtype_2_pp"</span>, <span class="st">"weather"</span>),
    <span class="kw">modelName</span> <span class="kw">=</span> <span class="st">"fireSense_SpreadFitted"</span> <span class="co"># This is the default</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">outputs</span> <span class="kw">=</span> <span class="no">outputs</span>,
  <span class="kw">params</span> <span class="kw">=</span> <span class="no">parameters</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)</pre></body></html></div>
</div>
</div>
<div id="run-firesense-finally" class="section level2">
<h2 class="hasAnchor">
<a href="#run-firesense-finally" class="anchor"></a>Run fireSense, finally!</h2>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">modules</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"fireSense"</span>)

<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">start</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="co"># Define fireSense module inputs</span>
<span class="no">inputs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="co"># Fire ignition rates</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">files</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(
      <span class="fu">getPaths</span>()$<span class="no">outputPath</span>,
      <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"fireSense_IgnitionPredicted"</span>,
      <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>
    ),
    <span class="kw">functions</span> <span class="kw">=</span> <span class="st">"raster::raster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"ignitionProbRaster"</span>,
    <span class="kw">loadTime</span> <span class="kw">=</span> <span class="fl">1</span>
  ),
  <span class="co"># Fire escape probabilities</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">files</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(
      <span class="fu">getPaths</span>()$<span class="no">outputPath</span>,
      <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"fireSense_EscapePredicted"</span>,
      <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>
    ),
    <span class="kw">functions</span> <span class="kw">=</span> <span class="st">"raster::raster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"escapeProbRaster"</span>,
    <span class="kw">loadTime</span> <span class="kw">=</span> <span class="fl">1</span>
  ),
  <span class="co"># Fire spread probabilities</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">files</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(
      <span class="fu">getPaths</span>()$<span class="no">outputPath</span>,
      <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"fireSense_SpreadPredicted"</span>,
      <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>
    ),
    <span class="kw">functions</span> <span class="kw">=</span> <span class="st">"raster::raster"</span>,
    <span class="kw">objectName</span> <span class="kw">=</span> <span class="st">"spreadProbRaster"</span>,
    <span class="kw">loadTime</span> <span class="kw">=</span> <span class="fl">1</span>
  )
)

<span class="co"># Run the simulation</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu">simInitAndSpades</span>(
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="no">inputs</span>,
  <span class="kw">modules</span> <span class="kw">=</span> <span class="no">modules</span>,
  <span class="kw">objects</span> <span class="kw">=</span> <span class="no">objects</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">times</span>
)

<span class="no">burnMap</span> <span class="kw">&lt;-</span> <span class="no">sim</span>$<span class="no">burnMap</span>

<span class="fu">Plot</span>(<span class="no">burnMap</span>)</pre></body></html></div>
<p>Note that all the steps above could be done in one simulation / SpaDES call()</p>
</div>
</div>
<div id="additional-resources" class="section level1">
<h1 class="hasAnchor">
<a href="#additional-resources" class="anchor"></a>Additional resources</h1>
<p>Read modules metadata, all module parameters are documented in Rmd files.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<!-- automatically generated -->
<div id="refs" class="references">
<div id="ref-Marchal2017">
<p>Marchal, Jean, Steve G. Cumming, and Eliot J. B. McIntire. 2017. “Exploiting Poisson additivity to predict fire frequency from maps of fire weather and land cover in boreal forests of Québec, Canada.” <em>Ecography</em> 40 (1): 200–209. <a href="https://doi.org/10.1111/ecog.01849">https://doi.org/10.1111/ecog.01849</a>.</p>
</div>
<div id="ref-Marchal2019">
<p>Marchal, Jean, Steven G. Cumming, and Eliot J. B. McIntire. 2019. “Turning Down the Heat: Vegetation Feedbacks Limit Fire Regime Responses to Global Warming.” <em>Ecosystems</em>, May. <a href="https://doi.org/10.1007/s10021-019-00398-2">https://doi.org/10.1007/s10021-019-00398-2</a>.</p>
</div>
<div id="ref-Schoenberg2003">
<p>Schoenberg, Frederic Paik, Roger Peng, and James Woods. 2003. “On the distribution of wildfire sizes.” <em>Environmetrics</em> 14 (6): 583–92. <a href="https://doi.org/10.1002/env.605">https://doi.org/10.1002/env.605</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jean Marchal, Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
