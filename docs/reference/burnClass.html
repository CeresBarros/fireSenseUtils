<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate, Summarize, Predict Burn Classes from Covariates — burnClassGenerator • fireSenseUtils</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate, Summarize, Predict Burn Classes from Covariates — burnClassGenerator" />
<meta property="og:description" content="Generate, Summarize, Predict Burn Classes from Covariates" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fireSenseUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fireSense-tutorial.html">fireSense tutorial</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/fireSenseUtils/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate, Summarize, Predict Burn Classes from Covariates</h1>
    <small class="dont-index">Source: <a href='https://github.com/PredictiveEcology/fireSenseUtils/blob/master/R/burnClass.R'><code>R/burnClass.R</code></a></small>
    <div class="hidden name"><code>burnClass.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate, Summarize, Predict Burn Classes from Covariates</p>
    </div>

    <pre class="usage"><span class='fu'>burnClassGenerator</span>(<span class='no'>df</span>, <span class='kw'>numClasses</span> <span class='kw'>=</span> <span class='fl'>4</span>:<span class='fl'>9</span>, <span class='kw'>AUC</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>plotAUC</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>burnClassSummary</span>(<span class='no'>mod</span>)

<span class='fu'>burnClassPredict</span>(<span class='no'>mod</span>, <span class='no'>df</span>)

<span class='fu'>burnProbFromClass</span>(<span class='no'>mod</span>, <span class='no'>df</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>A data.frame (or data.table), with covarites, including "burned" (a binary 0, 1
notburned = 0, burned = 1), e.g., timeSinceFire, biomassJackPine, etc. that will
be used to find fuel classes. This set of covariates must be available both during
fitting and for prediction. These must be quantitative.</p></td>
    </tr>
    <tr>
      <th>numClasses</th>
      <td><p>A vector indicating how many classes should be attempted. The function
will return the number of classes that best classify the data into homogeneous groups.</p></td>
    </tr>
    <tr>
      <th>AUC</th>
      <td><p>Logical. Should the Area Under the receiver operating Curve be returned?</p></td>
    </tr>
    <tr>
      <th>plotAUC</th>
      <td><p>Logical. Should the plot of the AUC be made.</p></td>
    </tr>
    <tr>
      <th>mod</th>
      <td><p>A model of class <code>Mclust</code>, e.g,. coming from <code>Mclust</code> or
<code>burnClassGenerator</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with 2 elements, first the <code>model</code>, which comes from <code><a href='https://mclust-org.github.io/mclust/reference/Mclust.html'>mclust::Mclust</a></code>,
and second the Area Under the Curve or AUC as an indicator of the overal goodness of fit.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This was inspired by reading here:
<a href='https://www.datanovia.com/en/blog/types-of-clustering-methods-overview-and-quick-start-r-code/'>https://www.datanovia.com/en/blog/types-of-clustering-methods-overview-and-quick-start-r-code/</a>
and here:
<a href='https://www.datanovia.com/en/lessons/model-based-clustering-essentials/'>https://www.datanovia.com/en/lessons/model-based-clustering-essentials/</a>, with
citation here:
Scrucca L., Fop M., Murphy T. B. and Raftery A. E. (2016) mclust 5: clustering,
classification and density estimation using Gaussian finite mixture models,
The R Journal, 8/1, pp. 205-233.
<a href='https://journal.r-project.org/archive/2016/RJ-2016-021/RJ-2016-021.pdf'>https://journal.r-project.org/archive/2016/RJ-2016-021/RJ-2016-021.pdf</a></p>
    <h2 class="hasAnchor" id="the-algorithm"><a class="anchor" href="#the-algorithm"></a>The algorithm</h2>

    

<p>The basic solution is to take all covariates, including the binary "not burned", "burned"
(coded as 0 and 1, respectively), and do model-based clustering with the <code>mclust</code>
R package. We can choose a fixed number of burn classes, or a finite range (see
<code>numClasses</code> argument.
This will make <code>numClasses</code> "homogeneous" groups,
including whether they burned or not.
From this, we can identify groups by looking at the mean values of "burned" to see
what their burn tendency is as a "homogeneous" group.</p>
    <h2 class="hasAnchor" id="categorical-data"><a class="anchor" href="#categorical-data"></a>Categorical data</h2>

    

<p>For now, it is recommended to convert categorical data to dummy variables, 0 and 1.
E.g., For land cover, wetland class can be converted to a column "wetland" with
1 for data points that are wetlands and 0 for non-wetland.</p>
    <h2 class="hasAnchor" id="how-much-data-to-include"><a class="anchor" href="#how-much-data-to-include"></a>How much data to include</h2>

    

<p>This has not been tested yet; however, I believe that having a relatively similar
number of "burned" and "unburned" pixels (within 3x either way), is probably a good idea.
In other words, if there are 100,000 burned data points, there should be between 30,000 and
300,000 unburned data points. If there are already buffers around the burned polygons that
include unburned pixels, then these buffers can be used as part of the unburned
content.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#################################</span>
<span class='co'># Use own data; here is a generated set for reprex</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='st'>"data.table"</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>1e5</span>
<span class='no'>DT</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"train"</span>, <span class='st'>"test"</span>)) {
  <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span>(<span class='kw'>burned</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='no'>N</span>))
  <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/assign.html'>set</a></span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>NULL</span>, <span class='st'>"jp"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span>(<span class='no'>N</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>4</span> + <span class='fl'>0.5</span> * <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>burned</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.25</span>))
  <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/assign.html'>set</a></span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>NULL</span>, <span class='st'>"bs"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span>(<span class='no'>N</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>4</span> + <span class='fl'>0.3</span> * <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>burned</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.25</span>))
  <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/assign.html'>set</a></span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>NULL</span>, <span class='st'>"ws"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span>(<span class='no'>N</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>4</span> + <span class='fl'>0.2</span> * <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>burned</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.25</span>))
  <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/assign.html'>set</a></span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>NULL</span>, <span class='st'>"age"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span>(<span class='no'>N</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>4</span> - <span class='fl'>0.2</span>* <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>burned</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.25</span>))
  <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]][, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"jp"</span>, <span class='st'>"bs"</span>, <span class='st'>"ws"</span>, <span class='st'>"age"</span>) <span class='kw'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>.SD</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='no'>x</span>/<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>x</span>) * <span class='fl'>1000</span>),
            <span class='kw'>.SDcols</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"jp"</span>, <span class='st'>"bs"</span>, <span class='st'>"ws"</span>, <span class='st'>"age"</span>)]
  <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]][, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"age"</span>) <span class='kw'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>.SD</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='no'>x</span>/<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>x</span>) * <span class='fl'>200</span>), <span class='kw'>.SDcols</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"age"</span>)]
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]])
  <span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>age</span> ~ <span class='no'>DT</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>burned</span>)
}

<span class='no'>bc</span> <span class='kw'>&lt;-</span> <span class='fu'>burnClassGenerator</span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='st'>"train"</span>]], <span class='fl'>4</span>:<span class='fl'>8</span>)
<span class='co'># Show if the model is good at predicting burn state</span>
(<span class='no'>bc</span>$<span class='no'>AUC</span>) <span class='co'># area under the curve</span>

<span class='co'># print summary of mean values of each burn class</span>
(<span class='no'>summ</span> <span class='kw'>&lt;-</span> <span class='fu'>burnClassSummary</span>(<span class='no'>bc</span>$<span class='no'>model</span>))

<span class='co'># predict -- add Burn Class to object</span>
<span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/assign.html'>set</a></span>(<span class='no'>DT</span><span class='kw'>[[</span><span class='st'>"test"</span>]], <span class='kw'>NULL</span>, <span class='st'>"burnClass"</span>, <span class='fu'>burnClassPredict</span>(<span class='no'>bc</span>$<span class='no'>model</span>, <span class='kw'>df</span> <span class='kw'>=</span> <span class='no'>DT</span><span class='kw'>[[</span><span class='st'>"test"</span>]]))
<span class='no'>prob</span> <span class='kw'>&lt;-</span> <span class='fu'>burnProbFromClass</span>(<span class='no'>bc</span>$<span class='no'>model</span>, <span class='no'>DT</span><span class='kw'>[[</span><span class='st'>"test"</span>]])

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jean Marchal, Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


